'use client'
import React from 'react'
import { Moon } from 'lucide-react'
import Link from 'next/link'
import WalletConnect from './WalletConnect'
import { Button } from './ui/button'
import { signIn, signOut, useSession } from 'next-auth/react'
import { redirect, useRouter } from 'next/navigation'

const Header = ({ dashboard }: { dashboard?: boolean }) => {
  const router = useRouter()
  const { data: session } = useSession()

  const handleSignIn = async () => {
    await signIn('google', { redirectTo: '/dashboard/my-habits' })
  }

  return (
    <nav className='sticky left-0 top-0  w-full h-16 flex items-center justify-between py-10 z-10 bg-background'>
      <div>
        <Link href='/'>
          <svg
            width='100'
            viewBox='0 0 660 142'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'
          >
            <path
              d='M0.551758 70.7666C0.551758 61.641 1.52702 52.8288 3.47754 44.3301C5.42806 35.8314 8.45833 28.3428 12.5684 21.8643C16.6784 15.3857 22.0423 10.196 28.6602 6.29492C35.3477 2.32422 43.3936 0.338867 52.7979 0.338867C62.2021 0.338867 70.2132 2.32422 76.8311 6.29492C83.5186 10.196 88.9521 15.3857 93.1318 21.8643C97.3115 28.3428 100.342 35.8314 102.223 44.3301C104.104 52.8288 105.044 61.641 105.044 70.7666C105.044 79.8923 104.104 88.7044 102.223 97.2031C100.342 105.632 97.3464 113.156 93.2363 119.773C89.1263 126.322 83.7275 131.581 77.04 135.552C70.4222 139.453 62.3415 141.403 52.7979 141.403C43.2542 141.403 35.1387 139.453 28.4512 135.552C21.8333 131.581 16.4346 126.322 12.2549 119.773C8.14486 113.156 5.18424 105.632 3.37305 97.2031C1.49219 88.7044 0.551758 79.8923 0.551758 70.7666ZM22.1816 70.7666C22.1816 77.1755 22.5996 83.3753 23.4355 89.3662L76.9355 35.6572C74.5671 30.9202 71.4323 27.0889 67.5312 24.1631C63.6999 21.2373 58.7887 19.7744 52.7979 19.7744C42.8363 19.7744 35.2432 24.2676 30.0186 33.2539C24.7939 42.2402 22.1816 54.7445 22.1816 70.7666ZM52.7979 121.863C58.9281 121.863 63.9437 120.366 67.8447 117.37C71.8154 114.375 74.9154 110.474 77.1445 105.667C79.4434 100.791 81.0456 95.2874 81.9512 89.1572C82.9264 83.027 83.4141 76.8968 83.4141 70.7666C83.4141 64.915 82.9961 59.2028 82.1602 53.6299L29.0781 106.921C31.4466 111.449 34.4769 115.071 38.1689 117.788C41.9307 120.505 46.807 121.863 52.7979 121.863ZM215.85 139H171.822V120.473H179.99L167.34 101.049L154.889 120.473H162.459V139H118.83V120.473H132.277L153.096 91.8848L133.273 64.791H120.822V46.1641H162.658V64.791H156.084L167.34 82.7207L178.795 64.791H171.424V46.1641H213.658V64.791H201.605L181.783 91.8848L202.602 120.473H215.85V139Z'
              fill='#06C270'
            />
            <path
              d='M321.734 103.34C321.734 109.316 320.705 114.662 318.646 119.377C316.654 124.025 313.898 127.977 310.379 131.23C306.926 134.484 302.775 136.975 297.928 138.701C293.146 140.428 288.033 141.291 282.588 141.291C276.479 141.291 270.967 140.195 266.053 138.004C261.139 135.812 256.922 132.193 253.402 127.146V139H234.875V96.5664H253.402C253.402 100.816 254.133 104.568 255.594 107.822C257.121 111.076 259.113 113.832 261.57 116.09C264.027 118.281 266.883 119.975 270.137 121.17C273.391 122.299 276.844 122.863 280.496 122.863C286.672 122.863 291.652 121.436 295.438 118.58C299.223 115.725 301.115 111.176 301.115 104.934C301.115 101.68 300.518 98.8906 299.322 96.5664C298.193 94.2422 296.533 92.1836 294.342 90.3906C292.217 88.5312 289.594 86.9375 286.473 85.6094C283.352 84.2148 279.799 82.7539 275.814 81.2266C271.1 79.6328 266.385 77.8398 261.67 75.8477C256.955 73.8555 252.738 71.3984 249.02 68.4766C245.301 65.5547 242.279 61.9688 239.955 57.7188C237.631 53.4023 236.469 47.9902 236.469 41.4824C236.469 35.7715 237.498 30.791 239.557 26.541C241.682 22.2246 244.471 18.6055 247.924 15.6836C251.443 12.7617 255.494 10.5703 260.076 9.10938C264.725 7.58203 269.639 6.81836 274.818 6.81836C280.795 6.81836 285.908 8.08008 290.158 10.6035C294.475 13.127 297.795 16.4805 300.119 20.6641V9.00977H318.646V49.4512H300.119C300.119 41.8145 298.094 35.8711 294.043 31.6211C290.059 27.3047 284.68 25.1465 277.906 25.1465C271.93 25.1465 266.949 26.541 262.965 29.3301C259.047 32.1191 257.088 36.0371 257.088 41.084C257.088 43.6738 257.586 45.8984 258.582 47.7578C259.645 49.5508 261.139 51.2109 263.064 52.7383C265.057 54.1992 267.547 55.5938 270.535 56.9219C273.523 58.1836 276.977 59.5781 280.895 61.1055C285.809 62.832 290.689 64.791 295.537 66.9824C300.385 69.1738 304.734 71.8633 308.586 75.0508C312.438 78.2383 315.592 82.123 318.049 86.7051C320.506 91.2207 321.734 96.7656 321.734 103.34ZM435.787 139H411.682L377.615 78.4375L369.049 88.5977V139H348.43V9.00977H369.049V60.0098L409.49 9.00977H435.986L390.664 62.8984L435.787 139ZM532.807 139H470.451V120.473H490.971V27.6367H470.451V9.00977H532.807V27.6367H511.59V120.473H532.807V139ZM659.111 47.8574C659.111 60.873 655.16 70.5684 647.258 76.9434C639.355 83.252 628.332 86.4062 614.188 86.4062H591.775V139H571.156V9.00977H613.988C628.266 9.00977 639.355 12.2969 647.258 18.8711C655.16 25.3789 659.111 35.041 659.111 47.8574ZM638.492 47.5586C638.492 40.918 636.301 35.9375 631.918 32.6172C627.602 29.2969 621.691 27.6367 614.188 27.6367H591.775V67.7793H614.188C621.691 67.7793 627.602 66.1191 631.918 62.7988C636.301 59.4785 638.492 54.3984 638.492 47.5586Z'
              fill='white'
            />
          </svg>
        </Link>
      </div>
      <div className='flex gap-2 items-center'>
        <div>
          <Moon size={24} className='text-tertiary' />
        </div>
        {dashboard && <WalletConnect />}
        {!session ? (
          <Button onClick={() => handleSignIn()}>Sign In</Button>
        ) : (
          !dashboard && (
            <>
              <Button onClick={() => redirect('/dashboard/my-habits')}>
                Dashboard
              </Button>
              <Button
                variant={'outline'}
                onClick={() => signOut({ redirectTo: '/' })}
              >
                Logout
              </Button>
            </>
          )
        )}
      </div>
    </nav>
  )
}

export default Header
